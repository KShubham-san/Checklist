<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Study Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    html.dark {
      background-color: #1f2937;
      color: white;
    }
  </style>
</head>
<body class="bg-white text-black dark:bg-gray-900 dark:text-white transition duration-300">
  <div class="p-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold">ðŸ“˜ Study Tracker</h1>
    <div class="flex gap-2 items-center">
      <button id="exportBtn" class="material-icons p-2 bg-gray-200 dark:bg-gray-700 rounded-full hover:bg-gray-300 transition">file_download</button>
      <label for="importInput" class="material-icons p-2 bg-gray-200 dark:bg-gray-700 rounded-full hover:bg-gray-300 cursor-pointer transition">file_upload</label>
      <input type="file" id="importInput" class="hidden">
      <button id="themeToggle" class="material-icons p-2 bg-gray-200 dark:bg-gray-700 rounded-full hover:bg-gray-300 transition">dark_mode</button>
    </div>
  </div>

  <div class="flex justify-center space-x-2 mb-4">
    <button class="tab-button px-4 py-2 rounded-full" data-subject="physics">Physics</button>
    <button class="tab-button px-4 py-2 rounded-full" data-subject="chemistry">Chemistry</button>
    <button class="tab-button px-4 py-2 rounded-full" data-subject="maths">Math</button>
  </div>

  <div id="trackers" class="space-y-6 p-4"></div>

  <script>
    const subjects = {
      physics: ["Mathematical Tools", "Motion in a Straight Line", "Motion in a Plane", "Relative Motion", "Laws of Motion", "Work, Energy and Power", "Circular Motion", "Centre of Mass & System of Particles", "Rotational Motion", "Oscillations", "Ray Optics and Optical Instruments", "Dual Nature", "Atoms", "Nuclei", "Thermal Properties of Matter", "Kinetic Theory", "Thermodynamics", "Mechanical Properties of Solids", "Mechanical Properties of Fluids", "Electric Charges and Fields & Potential", "Gravitation", "Current Electricity", "Electrostatic Potential and Capacitance", "Moving Charges and Magnetism", "Magnetism and Matter", "Electromagnetic Induction", "Alternating Current", "Waves", "Electromagnetic Waves", "Wave Optics", "Semiconductor Electronics: Materials, Devices and Simple Circuits", "Units and Measurements"],
      chemistry: ["Some Basic Concepts of Chemistry", "Redox Reaction", "Solutions", "Chemical Kinetics", "Thermodynamics", "Chemical Equilibrium", "Ionic Equilibrium", "Electrochemistry", "Structure of Atom", "State of Matter", "The Solid State", "Surface Chemistry", "Classification of Elements and Periodicity in Properties", "Chemical Bonding and Molecular Structure", "Coordination Compounds", "Principles of Qualitative Analysis (Salt Analysis)", "P-block Elements", "The d- and f-Block Elements", "General Principles and Processes of Isolation of Metals", "Hydrogen and its Compounds", "S-block Element", "Some Basic Principles and Techniques (IUPAC)", "General Organic Chemistry", "Isomerism", "Hydrocarbons", "Haloalkanes and Haloarenes", "Alcohols, Phenols and Ethers", "Aldehydes, Ketones and Carboxylic Acids", "Amines", "Biomolecules", "Polymers", "Chemistry in Everyday Life"],
      maths: ["Basic Mathematics", "Quadratic Equations", "Sequence and Series", "Trigonometric Functions", "Trigonometric Equations", "Permutations and Combinations", "Binomial Theorem", "Straight Lines", "Circles", "Conic Sections: Parabola", "Conic Sections: Ellipse", "Conic Sections: Hyperbola", "Determinants", "Matrices", "Sets", "Relations and Functions", "Inverse Trigonometric Functions", "Limit, Continuity and Differentiability", "Method of Differentiation", "Application of Derivatives", "Indefinite Integration", "Definite Integration", "Application of Integrals", "Differential Equation", "Vector Algebra", "Three Dimensional Geometry", "Complex Number", "Probability", "Statistics", "Solution of Triangle"]
    };

    const trackerData = JSON.parse(localStorage.getItem("studyProgress")) || {};
    const trackersContainer = document.getElementById("trackers");

    function generateTracker(subject) {
      trackersContainer.innerHTML = "";
      subjects[subject].forEach((chapterName, i) => {
        const id = `${subject}-chapter-${i + 1}`;
        const stored = trackerData[id] || {};
        const tracker = document.createElement("div");
        tracker.className = "bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow-md transition-all duration-500";

        const types = ["Notes", "HW", "DPP", "Qs practice", "PYQ", "Module"];

        const checkboxes = types.map(type => {
          const cbId = `${id}-${type}`;
          return `<label class="inline-flex items-center space-x-2 mr-4">
                    <input type="checkbox" class="tracker-checkbox" data-id="${id}" data-type="${type}" ${stored[type] ? "checked" : ""}>
                    <span>${type}</span>
                  </label>`;
        }).join("");

        const completed = Object.values(stored).filter(Boolean).length;
        const progress = (completed / types.length) * 100;

        tracker.innerHTML = `
          <div class="mb-2 flex justify-between items-center">
            <h2 class="text-lg font-semibold">${chapterName}</h2>
            <div class="w-24 h-2 bg-gray-300 rounded-full">
              <div class="h-2 bg-green-500 rounded-full" style="width: ${progress}%;"></div>
            </div>
          </div>
          <div class="flex flex-wrap gap-2">${checkboxes}</div>
        `;

        trackersContainer.appendChild(tracker);
      });
    }

    function saveData() {
      localStorage.setItem("studyProgress", JSON.stringify(trackerData));
    }

    function launchConfetti(type) {
      confetti({
        particleCount: type === "big" ? 100 : 50,
        spread: type === "big" ? 160 : 70,
        startVelocity: type === "big" ? 40 : undefined,
        origin: { y: 0.7 },
      });
    }

    document.addEventListener("change", function(e) {
      if (e.target.classList.contains("tracker-checkbox")) {
        const id = e.target.dataset.id;
        const type = e.target.dataset.type;
        if (!trackerData[id]) trackerData[id] = {};
        trackerData[id][type] = e.target.checked;
        saveData();
        const completed = Object.values(trackerData[id]).filter(Boolean).length;
        if (e.target.checked) launchConfetti("small");
        if (completed === 6) launchConfetti("big");
        generateTracker(currentSubject);
      }
    });

    let currentSubject = "physics";

    document.querySelectorAll(".tab-button").forEach(btn => {
      btn.addEventListener("click", () => {
        currentSubject = btn.dataset.subject;
        document.querySelectorAll(".tab-button").forEach(b => b.classList.remove("bg-blue-500", "text-white"));
        btn.classList.add("bg-blue-500", "text-white");
        generateTracker(currentSubject);
      });
    });

    document.getElementById("themeToggle").addEventListener("click", () => {
      document.documentElement.classList.toggle("dark");
    });

    document.getElementById("exportBtn").addEventListener("click", () => {
      const blob = new Blob([JSON.stringify(trackerData)], { type: "application/json" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "study-progress.json";
      a.click();
    });

    document.getElementById("importInput").addEventListener("change", (e) => {
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = JSON.parse(event.target.result);
          Object.assign(trackerData, data);
          saveData();
          generateTracker(currentSubject);
        } catch (err) {
          alert("Invalid file format");
        }
      };
      reader.readAsText(e.target.files[0]);
    });

    generateTracker(currentSubject);
    document.querySelector('[data-subject="physics"]').classList.add("bg-blue-500", "text-white");
  </script>
</body>
</html>
